<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Network Butcher: Quick Tutorial on aMLLibrary</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Network Butcher
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Just a normal butcher. A network butcher</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Quick Tutorial on aMLLibrary </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>As we already stated, aMLLibrary can be used by <a class="el" href="namespacenetwork__butcher.html">network_butcher</a> to generate and import the weights in the block graph. This package can be used to both perform the training of machine learning models and to perform inference.</p>
<h1><a class="anchor" id="autotoc_md11"></a>
Why is aMLLibrary used?</h1>
<p>aMLLibrary is used by the weight importer class block_aMLLibrary_Weight_Importer to generate and import the weights produced by the models of <a href="#1">[1]</a> in the block graph.</p>
<p>In particular, the general idea of block_aMLLibrary_Weight_Importer (that is detailed by <a href="#1">[1]</a> in his thesis) is to estimate the execution time of each layer in a Deep Neural Network on two devices (an edge device and a cloud device) by constructing a collection of regression models that should, a priori, estimate the layer execution time on each device. The training data for these models is obtained by running a profiler application on several Onnx models. The profiler will: 1) Construct the linear graph of the network (the linearized graph produced by Contrained_Block_Graph_Builder with mode 'output') 2) Measure the average time required to execute each 'node' of the linearized graph in the edge and cloud devices. General informations about the executed layers is also saved (the output tensor length, the MACs of the layers, the number of parameters and the number of executed layers as well as the time required to send the output tensor from the edge device to the cloud device)</p>
<p>Once a profiler application has produced the final result, the regression model for the chosen device can be computed in two steps: 1) Prepare a configuration file with the parameters for the training (see the example in the config/test1 and config/test2 folders). Here, a user can specify the allowed machine learning techniques to use, the parameters related to the training procedure, as well as the information related to the input CSV file (the columns containing the features and the variable to predict). 2) Run the training procedure by executing the following command in the aMLLibrary directory: </p><div class="fragment"><div class="line">python3 run.py -c config.ini -o output_directory</div>
</div><!-- fragment --><p>where config.ini is the configuration file and output_directory is the directory where the results will be stored. In particular, the directory will store the best model it managed to find as a .pickle file.</p>
<p>To perform the prediction using the previously generated model, we have to follow two steps: 1) Prepare a configuration file with the parameters for the inference (see the example in the config/predict_0.ini and and config/predict_1.ini files). 2) Run the inference procedure by executing the following command in the aMLLibrary directory: </p><div class="fragment"><div class="line">python3 predict.py -c predict_config.ini -r path_to_model -o prediction_folder</div>
</div><!-- fragment --><p> where predict_config.ini is the configuration file, path_to_model is the path to the model to use for the prediction and prediction_folder is the directory where the results will be stored.</p>
<p>Network Butcher will only execute the prediction part by generating, given the proper parameters and the regression models, the correct predict configuration files and by calling the 'predict' method of the 'Predictor' class. The output CSV files will then be read using a Csv_Weight_Importer.</p>
<p>Since the model training is a time-consuming process, we provide a set of pre-trained models (available in the models folder) that can be used to perform the inference. The models were trained using the CSV file in the 'inputs' folder (provided by <a href="#1">[1]</a>) and the configuration files in the 'config' folder.</p>
<h1><a class="anchor" id="autotoc_md12"></a>
References</h1>
<p><a class="anchor" id="1"></a>[1] Eduard Ionut, Chirica (2022). 'An approach and a tool for the performance profiling and prediction of partitioned Deep Neural Networks in Computing Continua environments' </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
